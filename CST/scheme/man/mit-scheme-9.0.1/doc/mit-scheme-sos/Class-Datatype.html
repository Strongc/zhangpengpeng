<html lang="en">
<head>
<title>Class Datatype - SOS 1.9</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="SOS 1.9">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Classes.html#Classes" title="Classes">
<link rel="prev" href="Classes.html#Classes" title="Classes">
<link rel="next" href="Predefined-Classes.html#Predefined-Classes" title="Predefined Classes">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual documents SOS 1.9.

Copyright (C) 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993,
    1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
    2005, 2006, 2007, 2008, 2009 Massachusetts Institute of Technology

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.2 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with the Front-Cover Texts
     being ``A GNU Manual,'' and with the Back-Cover Texts as in (a)
     below.  A copy of the license is included in the section entitled
     ``GNU Free Documentation License.''

     (a) The FSF's Back-Cover Text is: ``You have freedom to copy and
     modify this GNU Manual, like GNU software.  Copies published by
     the Free Software Foundation raise funds for GNU development.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Class-Datatype"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Predefined-Classes.html#Predefined-Classes">Predefined Classes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Classes.html#Classes">Classes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Classes.html#Classes">Classes</a>
<hr>
</div>

<h3 class="section">1.1 Class Datatype</h3>

<p>The procedures in this section may be used to construct and inspect
classes.

<div class="defun">
&mdash; Procedure: <b>make-class</b><var> name direct-superclasses direct-slots<a name="index-make_002dclass-16"></a></var><br>
<blockquote><p>Creates and returns a new class object.

        <p><var>Name</var> is used for debugging: it is a symbol that appears in the
printed representation of the class and has no role in the semantics of
the class.  Alternatively, <var>name</var> may be <code>#f</code> to indicate that
the class is anonymous.

        <p><var>Direct-superclasses</var> must be a list of class objects.  The new
class inherits both methods and slots from the classes in this list. 
Specifying the empty list for <var>direct-superclasses</var> is equivalent to
specifying <code>(list &lt;instance&gt;)</code>.

        <p><var>Direct-slots</var> describes additional slots that instances of this
class will have.  It is a list, each element of which must have one of
the following forms:

     <pre class="example">          <var>name</var>
          (<var>name</var> . <var>plist</var>)
</pre>
        <p class="noindent">where <var>name</var> is a symbol, and <var>plist</var> is a property list.  The
first of these two forms is equivalent to the second with an empty
<var>plist</var>.

        <p>Each of the elements of <var>direct-slots</var> defines one slot named
<var>name</var>.  <var>Plist</var> is used to describe additional properties of
that slot.  The following properties are recognized:

          <dl>
<dt><code>initial-value</code><dd>This property specifies the default initial value for the slot, i.e. 
the value stored in the slot when an instance is created and no value is
explicitly specified by the instance constructor.  If neither the
<code>initial-value</code> nor the <code>initializer</code> property is specified,
the slot has no default initial value.

          <br><dt><code>initializer</code><dd>This property specifies a procedure of no arguments that is called by an
instance constructor whenever an instance containing this slot is
created.  The value returned by the <code>initializer</code> procedure is the
initial value of the slot.

          <br><dt><code>accessor</code><dd>This property specifies a generic procedure; <code>make-class</code> will add
an accessor method for this slot to the procedure.  See <a href="Slots.html#Slots">Slots</a>.

          <br><dt><code>modifier</code><dd>This property specifies a generic procedure; <code>make-class</code> will add
a modifier method for this slot to the procedure.  See <a href="Slots.html#Slots">Slots</a>.

          <br><dt><code>initpred</code><dd>This property specifies a generic procedure; <code>make-class</code> will add
an &ldquo;initialized?&rdquo; predicate method for this slot to the procedure. 
See <a href="Slots.html#Slots">Slots</a>. 
</dl>

        <p>Slot properties are combined in slightly complicated ways.

          <ul>
<li>It is not allowed to specify both <code>initial-value</code> and
<code>initializer</code> for a slot in a given call to <code>make-class</code>; at
most one of these properties may be given.

          <li>If a slot is specified for a given class, and a slot of the same name is
inherited from a superclass, then the slot properties for the two slots
are combined.  Slot properties from the subclass shadow those of the
superclass.  However, if a superclass has a slot property, and the
subclass does not, the property is inherited.  The resulting class never
has more than one slot of a given name.

          <li>When combining superclass and subclass slots, <code>initial-value</code> and
<code>initializer</code> shadow one another.  In other words, regardless of
the inherited slot properties, the resulting slot has at most one of
these two properties. 
</ul>

        <p>Examples of <code>make-class</code>:

     <pre class="lisp">          (define &lt;cell&gt;
            (make-class '&lt;cell&gt; '() '()))
          
          (define-generic cell-name (cell))
          (define-generic cell-width (cell))
          (define-generic cell-height (cell))
          (define-generic cell-components (cell))
          (define-generic set-cell-components! (cell components))
          
          (define &lt;contact&gt;
            (make-class '&lt;contact&gt;
                        (list &lt;cell&gt;)
                        `((name accessor ,cell-name))))
          
          (define &lt;compound-cell&gt;
            (make-class '&lt;compound-cell&gt;
                        (list &lt;cell&gt;)
                        `((width accessor ,cell-width)
                          (height accessor ,cell-height)
                          (components accessor ,cell-components
                                      modifier ,set-cell-components!
                                      initial-value ()))))
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Syntax: <b>define-class</b><var> name direct-superclasses direct-slot <small class="dots">...</small><a name="index-define_002dclass-17"></a></var><br>
<blockquote><p>Define <var>name</var> to be a class.  In its basic form, <code>define-class</code>
might have been defined by

     <pre class="lisp">          (define-syntax define-class
            (syntax-rules ()
              ((define-class name (class ...) slot ...)
               (define name
                 (make-class (quote name)
                             (list class ...)
                             (quote (slot ...)))))))
</pre>
        <p>Note that slot properties are handled specially by <code>define-class</code>. 
If a <var>direct-slot</var> specifies a slot properties property list, the
keys of the property list (i.e. the even-numbered elements) are not
evaluated, while the datums of the property list <em>are</em> evaluated. 
The expansion above does not show the proper treatment of slot
properties.

        <p>In addition to the slot properties recognized by <code>make-class</code>,
<code>define-class</code> recognizes a special slot property, called
<code>define</code>.  The <code>define</code> property specifies that some or all of
the slot accessors should be defined here; that is, generic procedures
should be constructed and bound to variables, and then the accessor
methods added to them.

        <p>The argument to the <code>define</code> property is a list containing any
combination of the symbols <code>accessor</code>, <code>modifier</code>, and
<code>initpred</code>.  As an abbreviation, the argument may be one of these
symbols by itself, which is equivalent to the list containing that
symbol.  Also, the argument may be the symbol <code>standard</code>, which is
equivalent to <code>(accessor modifier)</code>.

        <p>The argument to <code>define</code> specifies the accessors that will be
defined by this form.  The accessors are defined using default names,
unless the names are overridden by the corresponding slot property.  The
default names for a class <code>&lt;foo&gt;</code> and a slot <code>bar</code> are
<code>foo-bar</code>, <code>set-foo-bar!</code>, and <code>foo-bar-initialized?</code>,
respectively for the accessor, modifier, and initpred.  For example,

     <pre class="lisp">          (define-class foo ()
            (bar define accessor))
</pre>
        <p class="noindent">defines an accessor called <code>foo-bar</code>, but

     <pre class="lisp">          (define-class foo ()
            (bar define accessor accessor foo/bar))
</pre>
        <p class="noindent">instead defines an accessor called <code>foo/bar</code>.  Finally,

     <pre class="lisp">          (define-class foo ()
            (bar accessor foo/bar))
</pre>
        <p class="noindent">doesn't define any accessor, but assumes that <code>foo/bar</code> is a
previously-defined generic procedure and adds an accessor method to it.

        <p><a name="index-class-options-18"></a><code>define-class</code> permits the specification of <dfn>class options</dfn>,
which are options that pertain to the class as a whole.  Class options
are specified by overloading <var>name</var>: instead of a symbol, specify a
pair whose <span class="sc">car</span> is a symbol and whose <span class="sc">cdr</span> is an alist.  The
following class options are recognized:

          <dl>
<dt><code>(predicate [</code><var>name</var><code>])</code><dd><a name="index-predicate-19"></a><a name="index-predicate_002c-class-option-20"></a>Specifies that a predicate procedure should be defined for this class. 
<var>Name</var> must be either a symbol or <code>#f</code>: a symbol specifies the
name that will be bound to the predicate procedure, and <code>#f</code>
specifies that no predicate procedure should be defined.  If <var>name</var>
is omitted, or if no <code>predicate</code> option is specified, a predicate
procedure is defined by appending <code>?</code> to the name of the class.  If
the class name is surrounded by angle brackets, they are stripped off
first.  For example, the default predicate name for the class
<code>&lt;foo&gt;</code> is <code>foo?</code>.

          <br><dt><code>(constructor [</code><var>name</var><code>] </code><var>slot-names</var><code> [</code><var>n-init-args</var><code>])</code><dd><a name="index-constructor-21"></a><a name="index-constructor_002c-class-option-22"></a>Specifies that a constructor procedure should be defined for this class. 
<var>Name</var> must be a symbol, which is the name that will be bound to the
constructor procedure; if omitted, a default name is formed by
prepending <code>make-</code> to the name of the class.  If the class name is
surrounded by angle brackets, they are stripped off first.  For example,
the default constructor name for the class <code>&lt;foo&gt;</code> is
<code>make-foo</code>.

          <p><var>Slot-names</var> and <var>n-init-args</var> correspond to the arguments of
the respective names accepted by <code>instance-constructor</code>, and can
take any of the allowed forms for those arguments.

          <br><dt><code>(separator </code><var>string</var><code>)</code><dd><a name="index-separator-23"></a><a name="index-separator_002c-class-option-24"></a>Specifies how names for slot accessors are constructed.  If this option
isn't given, the name of a slot accessor is formed by concatenating the
name of the class with the name of the slot, with a hyphen between them. 
When this option is given, <var>string</var> is used instead of the hyphen. 
For example, normally a slot accessor for the slot <code>bar</code> in the
class <code>foo</code> is called <code>foo-bar</code>.  A class option
<code>(separator ".")</code> will cause the slot accessor to be called
<code>foo.bar</code>, the modifier to be called <code>set-foo.bar!</code>, and the
initialization predicate to be called <code>foo.bar?</code>. 
</dl>

        <p>Examples of <code>define-class</code> (compare these to the similar examples
for <code>make-class</code>):

     <pre class="lisp">          (define-class &lt;cell&gt; ())
          
          (define-generic cell-name (cell))
          (define-generic cell-width (cell))
          (define-generic cell-height (cell))
          (define-generic cell-components (cell))
          (define-generic set-cell-components! (cell components))
          
          (define-class (&lt;contact&gt; (constructor (name) no-init)) (&lt;cell&gt;)
            (name accessor cell-name))
          
          (define-class (&lt;compound-cell&gt; (constructor ())) (&lt;cell&gt;)
            (width accessor cell-width)
            (height accessor cell-height)
            (components accessor cell-components
                        modifier set-cell-components!
                        initial-value '()))
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>make-trivial-subclass</b><var> superclass1 superclass2 <small class="dots">...</small><a name="index-make_002dtrivial_002dsubclass-25"></a></var><br>
<blockquote><p>This convenience procedure makes a subclass that defines no new slots,
and that inherits from the given superclasses.  It is equivalent to the
following

     <pre class="lisp">          (make-class (class-name <var>superclass1</var>)
                      (list <var>superclass1</var> <var>superclass2</var> ...)
                      '())
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>class?</b><var> object<a name="index-class_003f-26"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>object</var> is a class, otherwise returns
<code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>subclass?</b><var> class specializer<a name="index-subclass_003f-27"></a></var><br>
<blockquote><p>Returns <code>#t</code> if <var>class</var> is a subclass of <var>specializer</var>,
otherwise returns <code>#f</code>.  If <var>specializer</var> is a class, the
result follows from the above definition of subclass, except that a
class is a subclass of itself.  If <var>specializer</var> is a record type,
it is equivalent to having used the <code>record-type-class</code> of the
record type.  Finally, if <var>specializer</var> is a union specializer,
<code>subclass?</code> is true if <var>class</var> is a subclass of one or more of
the component classes of <var>specializer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>object-class</b><var> object<a name="index-object_002dclass-28"></a></var><br>
<blockquote><p>Returns the class of <var>object</var>.  <var>Object</var> may be any Scheme
object; if <var>object</var> is known to be an instance,
<code>instance-class</code> is faster than <code>object-class</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>class-name</b><var> class<a name="index-class_002dname-29"></a></var><br>
<blockquote><p>Returns the name of <var>class</var>.  This is the <var>name</var> argument passed
to <code>make-class</code> when <var>class</var> was created. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>class-direct-superclasses</b><var> class<a name="index-class_002ddirect_002dsuperclasses-30"></a></var><br>
<blockquote><p>Returns a list of the direct superclasses of <var>class</var>.  If a
non-empty <var>direct-superclasses</var> argument was passed to
<code>make-class</code> when <var>class</var> was created, this list is
<code>equal?</code> to that argument.  The returned value must not be
modified. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>class-direct-slot-names</b><var> class<a name="index-class_002ddirect_002dslot_002dnames-31"></a></var><br>
<blockquote><p>Returns a list of symbols that are the names of the direct slots of
<var>class</var>.  This list contains only those slots that were defined in
the call to <code>make-class</code> that created <var>class</var>; it does not
contain slots that were inherited.  The returned value must not be
modified. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>class-precedence-list</b><var> class<a name="index-class_002dprecedence_002dlist-32"></a></var><br>
<blockquote><p>Returns a list of the superclasses of <var>class</var>.  The order of this
list is significant: it is the method resolution order.  This list will
always have <var>class</var> as its first element, and <code>&lt;object&gt;</code> as its
last element.  The returned value must not be modified. 
</p></blockquote></div>

   </body></html>

