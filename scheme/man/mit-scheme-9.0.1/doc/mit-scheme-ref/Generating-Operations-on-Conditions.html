<html lang="en">
<head>
<title>Generating Operations on Conditions - MIT/GNU Scheme 9.0.1</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="MIT/GNU Scheme 9.0.1">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Condition-Instances.html#Condition-Instances" title="Condition Instances">
<link rel="prev" href="Condition-Instances.html#Condition-Instances" title="Condition Instances">
<link rel="next" href="Condition-State.html#Condition-State" title="Condition State">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual documents MIT/GNU Scheme 9.0.1.

Copyright (C) 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993,
    1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
    2005, 2006, 2007, 2008, 2009, 2010 Massachusetts Institute of
    Technology

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.2 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with the Front-Cover Texts
     being ``A GNU Manual,'' and with the Back-Cover Texts as in (a)
     below.  A copy of the license is included in the section entitled
     ``GNU Free Documentation License.''

     (a) The FSF's Back-Cover Text is: ``You have freedom to copy and
     modify this GNU Manual, like GNU software.  Copies published by
     the Free Software Foundation raise funds for GNU development.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Generating-Operations-on-Conditions"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Condition-State.html#Condition-State">Condition State</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Condition-Instances.html#Condition-Instances">Condition Instances</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Condition-Instances.html#Condition-Instances">Condition Instances</a>
<hr>
</div>

<h4 class="subsection">16.5.1 Generating Operations on Conditions</h4>

<p><a name="index-condition_002dconstructor-2892"></a><a name="index-condition_002daccessor-2893"></a><a name="index-condition_002dsignaller-2894"></a><a name="index-condition_002dpredicate-2895"></a>Scheme provides four procedures that take a condition type as input and
produce operations on the corresponding condition object.  These are
reminiscent of the operations on record types that produce record
operators (see <a href="Records.html#Records">Records</a>).  Given a condition type it is possible to
generate: a constructor for instances of the type (using
<code>condition-constructor</code>); an accessor to extract the contents of a
field in instances of the type (using <code>condition-accessor</code>); a
predicate to test for instances of the type (using
<code>condition-predicate</code>); and a procedure to create and signal an
instance of the type (using <code>condition-signaller</code>).

   <p>Notice that the creation of a condition object is distinct from
signalling an occurrence of the condition.  Condition objects are
first-class; they may be created and never signalled, or they may be
signalled more than once.  Further notice that there are no procedures
for modifying conditions; once created, a condition cannot be altered.

<div class="defun">
&mdash; procedure: <b>condition-constructor</b><var> condition-type field-names<a name="index-condition_002dconstructor-2896"></a></var><br>
<blockquote><p><a name="index-condition_002frestarts-2897"></a><a name="index-bound_002drestarts-2898"></a><a name="index-restarts_002c-bound-2899"></a>Returns a constructor procedure that takes as arguments values for the
fields specified in <var>field-names</var> and creates a condition of type
<var>condition-type</var>.  <var>Field-names</var> must be a list of symbols that
is a subset of the <var>field-names</var> in <var>condition-type</var>.  The
constructor procedure returned by <code>condition-constructor</code> has
signature

     <pre class="example">          (lambda (<var>continuation</var> <var>restarts</var> . <var>field-values</var>) ...)
</pre>
        <p class="noindent">where the <var>field-names</var> correspond to the <var>field-values</var>.  The
constructor argument <var>restarts</var> is described in <a href="Restarts.html#Restarts">Restarts</a>. 
Conditions created by the constructor procedure have <code>#f</code> for the
values of all fields other than those specified by <var>field-names</var>.

        <p>For example, the following procedure <code>make-simple-warning</code>
constructs a condition of type <code>condition-type:simple-warning</code>
given a continuation (where the condition occurred), a description of
the restarts to be made available, a warning message, and a list of
irritants that caused the warning:

     <pre class="example">          (define make-simple-warning
            (condition-constructor condition-type:simple-warning
                                   '(message irritants)))
</pre>
        </blockquote></div>

<div class="defun">
&mdash; procedure: <b>condition-accessor</b><var> condition-type field-name<a name="index-condition_002daccessor-2900"></a></var><br>
<blockquote><p><a name="index-specialization_002c-of-condition-types-2901"></a>Returns a procedure that takes as input a condition object of type
<var>condition-type</var> and extracts the contents of the specified
<var>field-name</var>.  <code>condition-accessor</code> signals
<code>error:bad-range-argument</code> if the <var>field-name</var> isn't one of the
named fields of <var>condition-type</var>; the returned procedure will signal
<code>error:wrong-type-argument</code> if passed an object other than a
condition of type <var>condition-type</var> or one of its specializations.

        <p><a name="index-access_002dcondition-2902"></a>If it is known in advance that a particular field of a condition will be
accessed repeatedly it is worth constructing an accessor for the field
using <code>condition-accessor</code> rather than using the (possibly more
convenient, but slower) <code>access-condition</code> procedure. 
</p></blockquote></div>

<div class="defun">
&mdash; procedure: <b>condition-predicate</b><var> condition-type<a name="index-condition_002dpredicate-2903"></a></var><br>
<blockquote><p><a name="index-specialization_002c-of-condition-types-2904"></a>Returns a predicate procedure for testing whether an object is a
condition of type <var>condition-type</var> or one of its specializations
(there is no predefined way to test for a condition of a given type but
<em>not</em> a specialization of that type). 
</p></blockquote></div>

<div class="defun">
&mdash; procedure: <b>condition-signaller</b><var> condition-type field-names default-handler<a name="index-condition_002dsignaller-2905"></a></var><br>
<blockquote><p>Returns a signalling procedure with parameters <var>field-names</var>.  When
the signalling procedure is called it creates and signals a condition of
type <var>condition-type</var>.  If the condition isn't handled (i.e. if no
handler is invoked that causes an escape from the current continuation)
the signalling procedure reduces to a call to <var>default-handler</var> with
the condition as its argument.

        <p>There are several standard procedures that are conventionally used for
<var>default-handler</var>.  If <var>condition-type</var> is a specialization of
<code>condition-type:error</code>, <var>default-handler</var> should be the
procedure<br> <code>standard-error-handler</code>.  If <var>condition-type</var> is a
specialization of <code>condition-type:warning</code>, <var>default-handler</var>
should be the procedure <code>standard-warning-handler</code>.  If
<var>condition-type</var> is a specialization of
<code>condition-type:breakpoint</code>, <var>default-handler</var> should be the
procedure <code>standard-breakpoint-handler</code>. 
</p></blockquote></div>

   </body></html>

