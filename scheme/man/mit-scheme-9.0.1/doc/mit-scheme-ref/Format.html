<html lang="en">
<head>
<title>Format - MIT/GNU Scheme 9.0.1</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="MIT/GNU Scheme 9.0.1">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Input_002fOutput.html#Input_002fOutput" title="Input/Output">
<link rel="prev" href="Output-Procedures.html#Output-Procedures" title="Output Procedures">
<link rel="next" href="Custom-Output.html#Custom-Output" title="Custom Output">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual documents MIT/GNU Scheme 9.0.1.

Copyright (C) 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993,
    1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
    2005, 2006, 2007, 2008, 2009, 2010 Massachusetts Institute of
    Technology

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.2 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with the Front-Cover Texts
     being ``A GNU Manual,'' and with the Back-Cover Texts as in (a)
     below.  A copy of the license is included in the section entitled
     ``GNU Free Documentation License.''

     (a) The FSF's Back-Cover Text is: ``You have freedom to copy and
     modify this GNU Manual, like GNU software.  Copies published by
     the Free Software Foundation raise funds for GNU development.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Format"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Custom-Output.html#Custom-Output">Custom Output</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Output-Procedures.html#Output-Procedures">Output Procedures</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Input_002fOutput.html#Input_002fOutput">Input/Output</a>
<hr>
</div>

<h3 class="section">14.6 Format</h3>

<!-- **** begin CLTL **** -->
<p>The procedure <code>format</code> is very useful for producing nicely
formatted text, producing good-looking messages, and so on.  MIT/GNU
Scheme's implementation of <code>format</code> is similar to that of Common
Lisp, except that Common Lisp defines many more
directives.<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>

   <p><a name="index-run_002dtime_002dloadable-option-2116"></a><a name="index-option_002c-run_002dtime_002dloadable-2117"></a><code>format</code> is a run-time-loadable option.  To use it, execute

<pre class="example">     (load-option 'format)
</pre>
   <p><a name="index-load_002doption-2118"></a>
once before calling it.

<div class="defun">
&mdash; procedure: <b>format</b><var> destination control-string argument <small class="dots">...</small><a name="index-format-2119"></a></var><br>
<blockquote><p><a name="index-write_002dstring-2120"></a><a name="index-format-directive-_0028defn_0029-2121"></a><a name="index-directive_002c-format-_0028defn_0029-2122"></a>Writes the characters of <var>control-string</var> to <var>destination</var>,
except that a tilde (<code>~</code>) introduces a <dfn>format directive</dfn>.  The
character after the tilde, possibly preceded by prefix parameters and
modifiers, specifies what kind of formatting is desired.  Most
directives use one or more <var>argument</var>s to create their output; the
typical directive puts the next <var>argument</var> into the output,
formatted in some special way.  It is an error if no argument remains
for a directive requiring an argument, but it is not an error if one or
more arguments remain unprocessed by a directive.

        <p>The output is sent to <var>destination</var>.  If <var>destination</var> is
<code>#f</code>, a string is created that contains the output; this string is
returned as the value of the call to <code>format</code>.  In all other cases
<code>format</code> returns an unspecified value.  If <var>destination</var> is
<code>#t</code>, the output is sent to the current output port.  Otherwise,
<var>destination</var> must be an output port, and the output is sent there.

        <p>This procedure performs discretionary output flushing (see <a href="Output-Procedures.html#Output-Procedures">Output Procedures</a>).

        <p>A <code>format</code> directive consists of a tilde (<code>~</code>), optional
prefix parameters separated by commas, optional colon (<code>:</code>) and
at-sign (<code>@</code>) modifiers, and a single character indicating what
kind of directive this is.  The alphabetic case of the directive
character is ignored.  The prefix parameters are generally integers,
notated as optionally signed decimal numbers.  If both the colon and
at-sign modifiers are given, they may appear in either order.

        <p><a name="index-V-as-format-parameter-2123"></a><a name="index-g_t_0023-as-format-parameter-2124"></a>In place of a prefix parameter to a directive, you can put the letter
&lsquo;<samp><span class="samp">V</span></samp>&rsquo; (or &lsquo;<samp><span class="samp">v</span></samp>&rsquo;), which takes an <var>argument</var> for use as a
parameter to the directive.  Normally this should be an exact integer. 
This feature allows variable-width fields and the like.  You can also
use the character &lsquo;<samp><span class="samp">#</span></samp>&rsquo; in place of a parameter; it represents the
number of arguments remaining to be processed.

        <p>It is an error to give a format directive more parameters than it is
described here as accepting.  It is also an error to give colon or
at-sign modifiers to a directive in a combination not specifically
described here as being meaningful.

          <dl>
<dt><code>~A</code><dd>The next <var>argument</var>, which may be any object, is printed as if by
<code>display</code>.  <code>~</code><var>mincol</var><code>A</code> inserts spaces on the right, if
necessary, to make the width at least <var>mincol</var> columns.  The
<code>@</code> modifier causes the spaces to be inserted on the left rather
than the right.

          <br><dt><code>~S</code><dd>The next <var>argument</var>, which may be any object, is printed as if by
<code>write</code>.  <code>~</code><var>mincol</var><code>S</code> inserts spaces on the right, if
necessary, to make the width at least <var>mincol</var> columns.  The
<code>@</code> modifier causes the spaces to be inserted on the left rather
than the right.

          <br><dt><code>~%</code><dd>This outputs a <code>#\newline</code> character.  <code>~</code><var>n</var><code>%</code> outputs
<var>n</var> newlines.  No <var>argument</var> is used.  Simply putting a newline
in <var>control-string</var> would work, but <code>~%</code> is often used because
it makes the control string look nicer in the middle of a program.

          <br><dt><code>~~</code><dd>This outputs a tilde.  <code>~</code><var>n</var><code>~</code> outputs <var>n</var> tildes.

          <br><dt><code>~</code><var>newline</var><dd>Tilde immediately followed by a newline ignores the newline and any
following non-newline whitespace characters.  With an <code>@</code>, the
newline is left in place, but any following whitespace is ignored.  This
directive is typically used when <var>control-string</var> is too long to fit
nicely into one line of the program:

          <pre class="example">               (define (type-clash-error procedure arg spec actual)
                 (format
                  #t
                  "~%Procedure ~S~%requires its %A argument ~
                   to be of type ~S,~%but it was called with ~
                   an argument of type ~S.~%"
                  procedure arg spec actual))
</pre>
          <pre class="example">               (type-clash-error 'vector-ref
                                 "first"
                                 'integer
                                 'vector)
               
               <span class="roman">prints</span>
               
               Procedure vector-ref
               requires its first argument to be of type integer,
               but it was called with an argument of type vector.
</pre>
          <p class="noindent">Note that in this example newlines appear in the output only as
specified by the <code>~%</code> directives; the actual newline characters in
the control string are suppressed because each is preceded by a tilde. 
</dl>
        </p></blockquote></div>

<!-- **** end CLTL **** -->
   <div class="footnote">
<hr>
<h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> This description of <code>format</code> is adapted from
<cite>Common Lisp, The Language</cite>, second edition, section 22.3.3.</p>

   <hr></div>

   </body></html>

