<html lang="en">
<head>
<title>Numerical input and output - MIT/GNU Scheme 9.0.1</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="MIT/GNU Scheme 9.0.1">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Numbers.html#Numbers" title="Numbers">
<link rel="prev" href="Numerical-operations.html#Numerical-operations" title="Numerical operations">
<link rel="next" href="Fixnum-and-Flonum-Operations.html#Fixnum-and-Flonum-Operations" title="Fixnum and Flonum Operations">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual documents MIT/GNU Scheme 9.0.1.

Copyright (C) 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993,
    1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
    2005, 2006, 2007, 2008, 2009, 2010 Massachusetts Institute of
    Technology

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.2 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with the Front-Cover Texts
     being ``A GNU Manual,'' and with the Back-Cover Texts as in (a)
     below.  A copy of the license is included in the section entitled
     ``GNU Free Documentation License.''

     (a) The FSF's Back-Cover Text is: ``You have freedom to copy and
     modify this GNU Manual, like GNU software.  Copies published by
     the Free Software Foundation raise funds for GNU development.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Numerical-input-and-output"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Fixnum-and-Flonum-Operations.html#Fixnum-and-Flonum-Operations">Fixnum and Flonum Operations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Numerical-operations.html#Numerical-operations">Numerical operations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Numbers.html#Numbers">Numbers</a>
<hr>
</div>

<h3 class="section">4.6 Numerical input and output</h3>

<p><a name="index-numerical-input-and-output-594"></a>

<div class="defun">
&mdash; procedure: <b>number-&gt;string</b><var> number </var>[<var>radix</var>]<var><a name="index-number_002d_003estring-595"></a></var><br>
<blockquote><p><var>Radix</var> must be an exact integer, either 2, 8, 10, or 16.  If
omitted, <var>radix</var> defaults to 10.  The procedure
<code>number-&gt;string</code> takes a number and a radix and returns as a string
an external representation of the given number in the given radix such
that

     <pre class="example">          (let ((number <var>number</var>)
                (radix <var>radix</var>))
            (eqv? number
                  (string-&gt;number (number-&gt;string number radix)
                                  radix)))
</pre>
        <p class="noindent">is true.  It is an error if no possible result makes this expression
true.

        <p>If <var>number</var> is inexact, the radix is 10, and the above expression
can be satisfied by a result that contains a decimal point, then the
result contains a decimal point and is expressed using the minimum
number of digits (exclusive of exponent and trailing zeroes) needed to
make the above expression true; otherwise the format of the result is
unspecified.

        <p>The result returned by <code>number-&gt;string</code> never contains an explicit
radix prefix.

        <p>Note: The error case can occur only when <var>number</var> is not a complex
number or is a complex number with an non-rational real or imaginary
part.

        <p>Rationale: If <var>number</var> is an inexact number represented using
flonums, and the radix is 10, then the above expression is normally
satisfied by a result containing a decimal point.  The unspecified case
allows for infinities, NaNs, and non-flonum representations. 
</p></blockquote></div>

<div class="defun">
&mdash; variable: <b>flonum-parser-fast?</b><var><a name="index-flonum_002dparser_002dfast_003f-596"></a></var><br>
<blockquote><p>This variable controls the behavior of <code>string-&gt;number</code> when
parsing inexact numbers.  Specifically, it allows the user to trade off
accuracy against speed.

        <p>When set to its default value, <code>#f</code>, the parser provides maximal
accuracy, as required by the Scheme standard.  If set to <code>#t</code>, the
parser uses faster algorithms that will sometimes introduce small errors
in the result.  The errors affect a few of the least-significant bits of
the result, and consequently can be tolerated by many applications. 
</p></blockquote></div>

<div class="defun">
&mdash; variable: <b>flonum-unparser-cutoff</b><var><a name="index-flonum_002dunparser_002dcutoff-597"></a></var><br>
<blockquote><p>This variable controls the action of <code>number-&gt;string</code> when
<var>number</var> is a flonum (and consequently controls all printing of
flonums).  The value of this variable is normally a list of three items:

          <dl>
<dt><var>rounding-type</var><dd>One of the following symbols: <code>normal</code>, <code>relative</code>, or
<code>absolute</code>.  The symbol <code>normal</code> means that the number should
be printed with full precision.  The symbol <code>relative</code> means that
the number should be rounded to a specific number of digits.  The symbol
<code>absolute</code> means that the number should be rounded so that there
are a specific number of digits to the right of the decimal point.

          <br><dt><var>precision</var><dd>An exact integer.  If <var>rounding-type</var> is <code>normal</code>,
<var>precision</var> is ignored.  If <var>rounding-type</var> is <code>relative</code>,
<var>precision</var> must be positive, and it specifies the number of digits
to which the printed representation will be rounded.  If
<var>rounding-type</var> is <code>absolute</code>, the printed representation will
be rounded <var>precision</var> digits to the right of the decimal point; if
<var>precision</var> is negative, the representation is rounded <code>(-
</code><var>precision</var><code>)</code> digits to the left of the decimal point.

          <br><dt><var>format-type</var><dd>One of the symbols: <code>normal</code>, <code>scientific</code>, or
<code>engineering</code>.  This specifies the format in which the number will
be printed.<br>  <code>scientific</code> specifies that the number will be printed
using scientific notation: <var>x</var><code>.</code><var>xxx</var><code>e</code><var>yyy</var>.  In other
words, the number is printed as a mantissa between zero inclusive and
ten exclusive, and an exponent.  <code>engineering</code> is like
<code>scientific</code>, except that the exponent is always a power of three,
and the mantissa is constrained to be between zero inclusive and 1000
exclusive.  If <code>normal</code> is specified, the number will be printed in
positional notation if it is &ldquo;small enough&rdquo;, otherwise it is printed
in scientific notation.  A number is &ldquo;small enough&rdquo; when the number of
digits that would be printed using positional notation does not exceed
the number of digits of precision in the underlying floating-point
number representation; <span class="sc">ieee</span> double-precision floating-point numbers
have 17 digits of precision. 
</dl>

     <p class="noindent">This three-element list may be abbreviated in two ways.  First, the
symbol <code>normal</code> may be used, which is equivalent to the list
<code>(normal 0 normal)</code>.  Second, the third element of the list,
<var>format-type</var>, may be omitted, in which case it defaults to
<code>normal</code>.

     <p class="noindent">The default value for <code>flonum-unparser-cutoff</code> is <code>normal</code>. 
If it is bound to a value different from those described here,
<code>number-&gt;string</code> issues a warning and acts as though the value had
been <code>normal</code>. 
</p></blockquote></div>

<p class="noindent">Some examples of <code>flonum-unparser-cutoff</code>:

<pre class="example">     (number-&gt;string (* 4 (atan 1 1)))
                                         &rArr; "3.141592653589793"
     (fluid-let ((flonum-unparser-cutoff '(relative 5)))
       (number-&gt;string (* 4 (atan 1 1))))
                                         &rArr; "3.1416"
     (fluid-let ((flonum-unparser-cutoff '(relative 5)))
       (number-&gt;string (* 4000 (atan 1 1))))
                                         &rArr; "3141.6"
     (fluid-let ((flonum-unparser-cutoff '(relative 5 scientific)))
       (number-&gt;string (* 4000 (atan 1 1))))
                                         &rArr; "3.1416e3"
     (fluid-let ((flonum-unparser-cutoff '(relative 5 scientific)))
       (number-&gt;string (* 40000 (atan 1 1))))
                                         &rArr; "3.1416e4"
     (fluid-let ((flonum-unparser-cutoff '(relative 5 engineering)))
       (number-&gt;string (* 40000 (atan 1 1))))
                                         &rArr; "31.416e3"
     (fluid-let ((flonum-unparser-cutoff '(absolute 5)))
       (number-&gt;string (* 4 (atan 1 1))))
                                         &rArr; "3.14159"
     (fluid-let ((flonum-unparser-cutoff '(absolute 5)))
       (number-&gt;string (* 4000 (atan 1 1))))
                                         &rArr; "3141.59265"
     (fluid-let ((flonum-unparser-cutoff '(absolute -4)))
       (number-&gt;string (* 4e10 (atan 1 1))))
                                         &rArr; "31415930000."
     (fluid-let ((flonum-unparser-cutoff '(absolute -4 scientific)))
       (number-&gt;string (* 4e10 (atan 1 1))))
                                         &rArr; "3.141593e10"
     (fluid-let ((flonum-unparser-cutoff '(absolute -4 engineering)))
       (number-&gt;string (* 4e10 (atan 1 1))))
                                         &rArr; "31.41593e9"
     (fluid-let ((flonum-unparser-cutoff '(absolute -5)))
       (number-&gt;string (* 4e10 (atan 1 1))))
                                         &rArr; "31415900000."
</pre>
   <div class="defun">
&mdash; procedure: <b>string-&gt;number</b><var> string </var>[<var>radix</var>]<var><a name="index-string_002d_003enumber-598"></a></var><br>
<blockquote><p>Returns a number of the maximally precise representation expressed by
the given <var>string</var>.  <var>Radix</var> must be an exact integer, either 2,
8, 10, or 16.  If supplied, <var>radix</var> is a default radix that may be
overridden by an explicit radix prefix in <var>string</var> (e.g. 
<code>"#o177"</code>).  If <var>radix</var> is not supplied, then the default radix
is 10.  If <var>string</var> is not a syntactically valid notation for a
number, then <code>string-&gt;number</code> returns <code>#f</code>.

     <pre class="example">          (string-&gt;number "100")        &rArr;  100
          (string-&gt;number "100" 16)     &rArr;  256
          (string-&gt;number "1e2")        &rArr;  100.0
          (string-&gt;number "15##")       &rArr;  1500.0
</pre>
        <p class="noindent">Note that a numeric representation using a decimal point or an exponent
marker is not recognized unless <var>radix</var> is <code>10</code>. 
</p></blockquote></div>

   </body></html>

